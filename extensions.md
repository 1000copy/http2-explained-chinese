# 扩展

协议强制规定接收方必须识别并忽略掉所有未知帧类型的帧。双方必须在逐跳原则（hop- by-hop basis）基础上协商新的帧，这些帧不能改变状态，并且也不在流量控制范围内

在制定http2协议的时候，关于它是否应该完全允许扩展的这个主题被反复讨论了很久。在draft-12之后，结果最终定格——扩展再次被允许。

扩展不再是协议本身的一部分，而是被记录在核心协议规范之外。至此，已经有两种帧类型经过http2工作组讨论被包含在协议里，它们很可能是率先被纳入协议的帧类型。由于它们的流行度，并且之前被当作“原生”帧，接下来我会详细讨论。

**7.1. 备选服务**

随着http2逐渐被接受，有理由猜测，相对于HTTP 1.x，TCP连接会变得更持久。从客户端到每个主机/站点只需要一条单独的连接即可满足，并且每个连接也将被隐式地维持更长的时间

这会影响到HTTP负载均衡器的正常工作，或者当一个网站想建议客户端们连接另外一个主机的时候，也可能导致问题。这可能是因为性能而考虑，也可能是网站正常维护或类似原因。

服务器将会通过发送Alt-Svc头（或者http2的ALTSVC帧）通知客户端备选服务。即另外一条获取同样内容的路由，指向不同的服务，主机和端口。

至此，如果客户端想异步地获取服务，那么它只能使用正常工作的备选者

**7.1.1. 机会型TLS**

Alt-Svc 头部允许服务器通过*http://*告诉客户端：同样的内容也可以通过TLS连接来获取。

这是个还在讨论中的功能。这样的连接会导致未认证的TLS，并且在任何地方也不会被广播为“安全”，同时不会在客户端界面上出现任何锁标识，甚至用户根本不知道这是一个过时的常规HTTP连接。虽然很多人不遗余力地反对，但这就是机会型TLS。

**7.2. 阻塞**

当有数据需要被发送，而流量控制禁止发送任何数据时，此类型的帧将会被发送，但有且仅有一次。此帧设计的目的在于，如果你的实现收到了此帧，那么实现中必然有错或者是得到了低于期望的传输速度

在此帧成为扩展之前，draft-12中的一段话：

> 阻塞帧被包含在此版本的草案中作为实验，如果没有得到良好的反馈，就把它删除
