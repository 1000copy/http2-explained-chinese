# http2协议（未完成）

背景介绍就到此为止了，历史的脚步将我们推到了现在这一步。让我们深入看看该协议的细节特性。

**6.1. 二进制**

http2是一个二进制协议。

仔细想想，如果你是一个曾经跟互联网协议打过交道，那你很可能本能反对二进制协议。

**6.2. 二进制格式**

http2发送二进制帧。几种帧都有相同的设置：

Type, Length, Flags, Steam Identifier和frame payload

http2的规范一共定义了10种不同的帧，其中最基础的两种分别对应于HTTP 1.1的DATA和HEADERS。接下来我会更详细的介绍一些帧。

**6.3. 多路复用的流**

上一节提到的Stream Identifier定义了二进制帧的格式，这让http2上传输的所有帧关联到一个“流”。流是一个逻辑上的结合，一个独立的，双向的连续帧客户端和服务器端交换的http2连接。

每个单独的http2连接都可以包含多个并发的流，。流既可以被客户端/服务器端单方面的建立、使用，也可以被双方共享。同时，两边都可以关闭流。在同一个流里面，每一帧发送的顺序非常关键。接收方会按照收到帧的顺序来进行处理。

流的多路复用意味着在同一连接中，每个包可能混合在多个流里面。两个（或者更多）独立的“数据火车”被拼凑到了一列车上，再在终点站被分开。下面就是两列“数据火车”

【图】

他们就是这样用多路复用的方式被塞到了同一列火车上。

【图】

在http2里面，我们很容易可以看到10个甚至100个同时并存的流。创建一个新的流的代价也非常低。

**6.4. 优先级和依赖关系**

每个流都包含一个优先级，优先级被用来告诉同伴哪个流更加的重要。

优先级在协议里具体的工作原理改变了很多次，当前也仍然在讨论。关键点在于客户端要能指定哪个流更重要，并且该参数需要是一个依赖参数，这样一个流才能依赖于另外一个。

优先级能动态的被改变，这可以让用户滚动一个全是图片的页面的时候，浏览器可以指定哪个图片有更高的优先级。或者是在你切换标签页的时候，浏览器可以指定新页面所包含流的优先级。

**6.5. 头压缩**

HTTP是无状态协议。简而言之，这意味着每个请求必须要包含服务器需要的所有细节，而不是让服务器保存住之前请求的元数据。因为http2没有改变这些范式，所以它也需要这样。

这也让HTTP成为可重复的。当一个客户端从同一服务器请求一些资源（例如页面的图片）的时候，